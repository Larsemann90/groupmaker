<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>GroupMaker Pro – Stärke-Skala</title>
<style>
body{font-family:sans-serif;margin:0;padding:0;background:#f8fafc;color:#0f172a}
.container{max-width:880px;margin:0 auto;padding:18px}
.tab-content{display:none;}
.tab-content.active{display:block;}
.card{background:#fff;padding:12px;border-radius:14px;margin-top:12px;box-shadow:0 2px 6px rgba(0,0,0,0.05)}
.btn{padding:8px 12px;background:#2563eb;color:white;border:none;border-radius:10px;cursor:pointer;margin:3px}
.muted{color:#6b7280}
.student-row{display:flex;align-items:center;gap:12px;margin-bottom:6px}
.star{font-size:20px;color:#e5e7eb;cursor:pointer}
.star.filled{color:#facc15}
</style>
</head>
<body>
<div class="container">
<h1>GroupMaker Pro</h1>

<!-- Startseite -->
<div id="start" class="tab-content active card">
  <h2>Gespeicherte Listen</h2>
  <div id="savedListsContainer"></div>
  <div style="margin-top:12px">
    <input id="newListName" placeholder="Neue Liste Name">
    <button id="createListBtn" class="btn">Neue Liste anlegen</button>
  </div>
  <div style="margin-top:12px">
    <button id="quickNumberListBtn" class="btn">Schnelle Liste mit Zahlen</button>
  </div>
</div>

<!-- Liste Detailansicht -->
<div id="listDetail" class="tab-content card">
  <h3 id="listTitle">Liste</h3>
  <div id="studentsContainer"></div>
  <button id="backToStart" class="btn" style="margin-top:12px">Zurück zur Startseite</button>
</div>

</div>

<script>
// STORAGE
const storage={get(k,d){try{const v=JSON.parse(localStorage.getItem(k));return v===null?d:v}catch(e){return d}},set(k,v){localStorage.setItem(k,JSON.stringify(v))}};
let lists=storage.get('gm_lists',{});

// TABS / START
const startTab=document.getElementById('start');
const listDetailTab=document.getElementById('listDetail');

function showTab(tab){startTab.style.display='none';listDetailTab.style.display='none';tab.style.display='block';}

function renderSavedLists(){
  const container=document.getElementById('savedListsContainer');
  container.innerHTML='';
  Object.keys(lists).forEach(name=>{
    const btn=document.createElement('button');
    btn.textContent=name;
    btn.className='btn';
    btn.addEventListener('click',()=>openList(name));
    container.appendChild(btn);
  });
}
renderSavedLists();

// NEUE LISTE
document.getElementById('createListBtn').addEventListener('click',()=>{
  const name=document.getElementById('newListName').value.trim();
  if(!name)return alert('Bitte einen Namen eingeben');
  if(lists[name]) return alert('Liste existiert bereits');
  lists[name]=[];
  storage.set('gm_lists',lists);
  document.getElementById('newListName').value='';
  renderSavedLists();
});

// SCHNELLE LISTE MIT ZAHLEN
document.getElementById('quickNumberListBtn').addEventListener('click',()=>{
  const count=prompt("Anzahl Schüler?");
  const num=parseInt(count);
  if(isNaN(num)||num<1)return;
  const name=prompt("Name der Liste?") || "Zahlenliste";
  lists[name]=Array.from({length:num},(_,i)=>({name:String(i+1),skill:0}));
  storage.set('gm_lists',lists);
  renderSavedLists();
});

// LISTE ÖFFNEN
function openList(name){
  document.getElementById('listTitle').textContent=name;
  renderStudentList(name);
  showTab(listDetailTab);
}

// ZURÜCK
document.getElementById('backToStart').addEventListener('click',()=>{
  showTab(startTab);
});

// STUDENTEN RENDERN MIT STERNE
function renderStudentList(listName){
  const container=document.getElementById('studentsContainer');
  container.innerHTML='';
  const list=lists[listName];
  list.forEach((student,index)=>{
    const row=document.createElement('div');
    row.className='student-row';
    const nameSpan=document.createElement('span');
    nameSpan.textContent=student.name;
    row.appendChild(nameSpan);
    for(let i=1;i<=10;i++){
      const star=document.createElement('span');
      star.className='star'+(i<=student.skill?' filled':'');
      star.innerHTML='★';
      star.dataset.index=i;
      star.addEventListener('click',()=>{
        student.skill=i;
        lists[listName][index].skill=i;
        storage.set('gm_lists',lists);
        renderStudentList(listName);
      });
      row.appendChild(star);
    }
    container.appendChild(row);
  });
}
</script>
</body>
</html>
